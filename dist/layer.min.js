/*!
 * @autofe/layer v0.3.0
 * (c) 2018 Autohome Inc.
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],t):(e.AutoFE=e.AutoFE||{},e.AutoFE.Layer=t(e.jQuery))}(this,function(e){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e;var t="layer",o="fe.layer",i="."+o,n=e.fn[t],a={SHOW:"show"+i,SHOWN:"shown"+i,HIDE:"hide"+i,HIDDEN:"hidden"+i,RESIZE:"resize"+i,CLICK_DISMISS:"click.dismiss"+i,KEYDOWN_DISMISS:"keydown.dismiss"+i,CLICK_DATA_API:"click"+i+".data-api"},s='[data-toggle="layer"]',r='[data-dismiss="layer"]';function d(t,o){this.options=e.extend({},d.Default,o),this.$elem=e(t),this.$back=null,this.isShown=!1,this.isFixed=!0,this.$elem.css({zIndex:1001})}function c(t,i){return this.each(function(){var n=e(this),a=n.data(o),s=e.extend({},d.Default,n.data(),"object"==typeof t&&t);if(a||(a=new d(this,s),n.data(o,a)),"string"==typeof t){if("undefined"==typeof a[t])throw new TypeError('No method named "'+t+'"');a[t](i)}else s.show&&a.show(i)})}return d.Default={keyboard:!0,backdrop:!0,opacity:.5,show:!0,time:0},d.prototype.toggle=function(e){return this.isShown?this.hide():this.show(e)},d.prototype.show=function(t){var o=this;if(!o.isShown){var i=e.Event(a.SHOW,{relatedTarget:t});o.$elem.trigger(i),o.isShown||i.isDefaultPrevented()||(o.isShown=!0,this._adjust(),o._setEscapeEvent(),o._setResizeEvent(),o.$elem.on(a.CLICK_DISMISS,r,e.proxy(o.hide,o)),o._setBackdrop(function(){o.$elem.css({display:"block"});var i=e.Event(a.SHOWN,{relatedTarget:t});o.$elem.trigger(i),o._effect("fadeIn");var n=o.options.time;n>0&&setTimeout(function(){o.hide()},n)}))}},d.prototype.hide=function(t){var o=this;if(t&&t.preventDefault(),o.isShown){var i=e.Event(a.HIDE);o.$elem.trigger(i),o.isShown&&!i.isDefaultPrevented()&&(o.isShown=!1,o._setEscapeEvent(),o._setResizeEvent(),o.$elem.off(a.CLICK_DISMISS),o._effect("fadeOut",function(){o.$elem.css({display:"none"}),o._setBackdrop(),o.$elem.trigger(a.HIDDEN)}))}},d.prototype.handleUpdate=function(){this._adjust()},d.prototype._adjust=function(){var t=e(window).width(),o=e(window).height(),i=this.$elem.outerWidth(),n=this.$elem.outerHeight(),a={left:(t-i)/2};this.isFixed=!(n>o),this.isFixed?(a.position="fixed",a.top=(o-n)/2):(a.position="absolute",a.top=e(window).scrollTop()),this.$elem.css(a)},d.prototype._setEscapeEvent=function(){var t=this;t.options.keyboard&&(t.isShown?e(document).on(a.KEYDOWN_DISMISS,function(e){27===e.which&&(e.preventDefault(),t.hide())}):e(document).off(a.KEYDOWN_DISMISS))},d.prototype._setResizeEvent=function(){this.isShown?e(window).on(a.RESIZE,e.proxy(this.handleUpdate,this)):e(window).off(a.RESIZE)},d.prototype._setBackdrop=function(t){var o=this,i=o.options;i.backdrop?o.isShown?(o.$back=e('<div style="position:fixed;top:0;right:0;bottom:0;left:0;z-index:1000;background:#000;opacity:0;"></div>').appendTo(document.body),"lock"!==i.backdrop&&o.$back.on(a.CLICK_DISMISS,e.proxy(o.hide,o)),o.$back.animate({opacity:i.opacity},150,t)):o.$back&&o.$back.animate({opacity:0},150,function(){o.$back.off(a.CLICK_DISMISS),o.$back.remove(),o.$back=null,t&&t()}):t&&t()},d.prototype._effect=function(e,t){switch(e){case"fadeIn":this.$elem.stop(!0).css({marginTop:-30,opacity:0}).animate({marginTop:0,opacity:1},300,t);break;case"fadeOut":this.$elem.stop(!0).animate({marginTop:-30,opacity:0},300,t)}},e(document).on(a.CLICK_DATA_API,s,function(t){var i=e(this),n=e(i.attr("data-target")),a=n.data(o)?"toggle":e.extend({},n.data(),i.data());"A"!==this.tagName&&"AREA"!==this.tagName||t.preventDefault(),c.call(n,a,this)}),e.fn[t]=c,e.fn[t].Constructor=d,e.fn[t].noConflict=function(){return e.fn[t]=n,c},d});